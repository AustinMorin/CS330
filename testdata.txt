select Industry, count(*)
  from Performance
  group by Industry
  order by Industry;
  
Industry	count(*)
Consumer Discretionary	312
Consumer Staples	684
Energy	429
Financials	2400
Health Care	960
Industrials	660
Materials	1073
Telecommunications Services	273
Utilities	561

select Industry, min(Ticker) as Ticker, count(distinct Ticker) as NumTicker
  from Performance
  group by Industry
  order by Industry;

Industry	Ticker	NumTicker
Consumer Discretionary	AMZN	78
Consumer Staples	ADM	38
Energy	ANR	39
Financials	ACE	80
Health Care	ABC	48
Industrials	APH	60
Materials	AA	29
Telecommunications Services	AMT	7
Utilities	AEE	33

select Ticker, StartDate, EndDate, round(TickerReturn, 4) as TickerReturn, round(IndustryReturn, 4) as IndustryReturn
  from Performance
  where Industry = 'Telecommunications Services'
  order by StartDate, Ticker
  limit 50;
  
Ticker	StartDate	EndDate	TickerReturn	IndustryReturn
AMT	2005.02.09	2005.05.05	-0.0381	-0.0823
CTL	2005.02.09	2005.05.05	-0.0804	-0.0752
FTR	2005.02.09	2005.05.05	-0.0765	-0.0759
S	2005.02.09	2005.05.05	-0.0870	-0.0741
T	2005.02.09	2005.05.05	-0.0401	-0.0819
VZ	2005.02.09	2005.05.05	-0.0603	-0.0786
WIN	2005.02.09	2005.05.05	-0.1492	-0.0637
AMT	2005.05.06	2005.08.01	0.2986	0.0744
CTL	2005.05.06	2005.08.01	0.1302	0.1025
FTR	2005.05.06	2005.08.01	0.0403	0.1175
S	2005.05.06	2005.08.01	0.2185	0.0878
T	2005.05.06	2005.08.01	0.0312	0.1190
VZ	2005.05.06	2005.08.01	-0.0151	0.1267
WIN	2005.05.06	2005.08.01	0.0414	0.1173
AMT	2005.08.02	2005.10.25	0.0377	-0.0758
CTL	2005.08.02	2005.10.25	-0.0572	-0.0600
FTR	2005.08.02	2005.10.25	-0.0502	-0.0611
S	2005.08.02	2005.10.25	-0.1182	-0.0498
T	2005.08.02	2005.10.25	-0.0319	-0.0642
VZ	2005.08.02	2005.10.25	-0.1057	-0.0519
WIN	2005.08.02	2005.10.25	-0.0916	-0.0542
AMT	2005.10.26	2006.01.23	0.2157	-0.0057
CTL	2005.10.26	2006.01.23	0.0149	0.0278
FTR	2005.10.26	2006.01.23	-0.0320	0.0356
S	2005.10.26	2006.01.23	-0.0133	0.0325
T	2005.10.26	2006.01.23	0.0316	0.0250
VZ	2005.10.26	2006.01.23	0.0231	0.0264
WIN	2005.10.26	2006.01.23	-0.0584	0.0400
AMT	2006.01.24	2006.04.19	0.1263	0.1034
CTL	2006.01.24	2006.04.19	0.1495	0.0995
FTR	2006.01.24	2006.04.19	0.1132	0.1055
S	2006.01.24	2006.04.19	0.1172	0.1049
T	2006.01.24	2006.04.19	0.0510	0.1159
VZ	2006.01.24	2006.04.19	0.0507	0.1160
WIN	2006.01.24	2006.04.19	0.1386	0.1013
AMT	2006.04.20	2006.07.14	-0.0612	-0.0874
CTL	2006.04.20	2006.07.14	-0.0561	-0.0883
FTR	2006.04.20	2006.07.14	-0.0726	-0.0855
S	2006.04.20	2006.07.14	-0.2537	-0.0553
T	2006.04.20	2006.07.14	0.0322	-0.1030
VZ	2006.04.20	2006.07.14	-0.0321	-0.0923
WIN	2006.04.20	2006.07.14	-0.1421	-0.0739
AMT	2006.07.17	2006.10.09	0.2234	0.1191
CTL	2006.07.17	2006.10.09	0.0988	0.1399
FTR	2006.07.17	2006.10.09	0.1388	0.1332
S	2006.07.17	2006.10.09	-0.0598	0.1663
T	2006.07.17	2006.10.09	0.2107	0.1212
VZ	2006.07.17	2006.10.09	0.1570	0.1302
WIN	2006.07.17	2006.10.09	0.1691	0.1282
AMT	2006.10.10	2007.01.05	0.0091	0.0458

select Ticker, StartDate, EndDate, round(TickerReturn, 4) as TickerReturn, round(IndustryReturn, 4) as IndustryReturn
  from Performance
  order by TickerReturn - IndustryReturn DESC
  limit 30;

Ticker	StartDate	EndDate	TickerReturn	IndustryReturn
TIE	2013.01.02	2013.03.28	738.3939	0.0186
C	2011.04.05	2011.06.29	8.3049	-0.0502
ETFC	2010.04.23	2010.07.19	6.1257	-0.1448
AIG	2009.05.11	2009.08.04	5.8980	0.0962
THC	2012.09.25	2012.12.20	4.2839	0.0187
FITB	2009.02.12	2009.05.08	3.1014	0.4668
DUK	2012.05.10	2012.08.03	2.1627	0.0641
AIG	2009.08.05	2009.10.28	1.5902	0.0359
HBAN	2009.02.12	2009.05.08	1.8729	0.4823
OI	2009.03.11	2009.06.04	1.7514	0.5973
IP	2009.03.11	2009.06.04	1.6943	0.5993
WFM	2009.02.11	2009.05.07	1.1302	0.0375
DOW	2009.03.11	2009.06.04	1.6426	0.6012
ZION	2009.02.12	2009.05.08	1.5053	0.4870
ETFC	2009.02.12	2009.05.08	1.5042	0.4870
XL	2009.02.12	2009.05.08	1.4877	0.4872
MS	2008.11.14	2009.02.11	0.8082	-0.1848
BAC	2009.02.12	2009.05.08	1.4773	0.4873
COF	2009.02.12	2009.05.08	1.4542	0.4876
MOS	2007.10.04	2007.12.28	0.9299	0.0237
CBG	2009.02.12	2009.05.08	1.3308	0.4892
TIE	2006.02.02	2006.04.28	0.8567	0.0533
HST	2009.02.12	2009.05.08	1.2547	0.4902
FCX	2008.12.11	2009.03.10	0.5146	-0.2290
STZ	2012.06.12	2012.09.05	0.7676	0.0334
AIG	2009.02.12	2009.05.08	1.2088	0.4907
GNW	2009.02.12	2009.05.08	1.1909	0.4910
FRX	2013.12.05	2014.03.04	0.7822	0.0944
ZION	2008.08.21	2008.11.13	0.3889	-0.2949
BAC	2011.12.20	2012.03.16	0.9178	0.2356

select Industry, StartDate, EndDate, round(sum(TickerReturn), 4) as TickerSum, round(sum(IndustryReturn), 4) as IndustrySum
  from Performance
  group by Industry, StartDate, EndDate
  having TickerSum != IndustrySum
  order by Industry, StartDate;

Industry	StartDate	EndDate	TickerSum	IndustrySum

select Ticker, StartDate, EndDate, round(TickerReturn, 4) as TickerReturn, round(IndustryReturn, 4) as IndustryReturn
  from Performance
  where Ticker = 'ETFC'
  order by StartDate;
  
Ticker	StartDate	EndDate	TickerReturn	IndustryReturn
ETFC	2007.06.14	2007.09.07	-0.3996	-0.1009
ETFC	2007.09.10	2007.12.03	-0.5832	0.0112
ETFC	2007.12.04	2008.02.29	0.0729	-0.1125
ETFC	2008.03.03	2008.05.27	-0.1051	0.0274
ETFC	2008.05.28	2008.08.20	-0.2500	-0.1304
ETFC	2008.08.21	2008.11.13	-0.4949	-0.2837
ETFC	2008.11.14	2009.02.11	-0.1769	-0.1724
ETFC	2009.02.12	2009.05.08	1.5042	0.4870
ETFC	2009.05.11	2009.08.04	-0.2448	0.1739
ETFC	2009.08.05	2009.10.28	0.0000	0.0560
ETFC	2009.10.29	2010.01.26	0.0800	0.0256
ETFC	2010.01.27	2010.04.22	0.1296	0.2109
ETFC	2010.04.23	2010.07.19	6.1257	-0.1448
ETFC	2010.07.20	2010.10.12	0.1575	0.1090
ETFC	2010.10.13	2011.01.06	0.0948	0.0957
ETFC	2011.01.07	2011.04.04	-0.0282	0.0333
ETFC	2011.04.05	2011.06.29	-0.1275	0.0566
ETFC	2011.06.30	2011.09.23	-0.2972	-0.2264
ETFC	2011.09.26	2011.12.19	-0.2434	0.0514
ETFC	2011.12.20	2012.03.16	0.4394	0.2417
ETFC	2012.03.19	2012.06.12	-0.2943	-0.0956
ETFC	2012.06.13	2012.09.06	0.0994	0.0939
ETFC	2012.09.07	2012.12.04	-0.0596	0.0014
ETFC	2012.12.05	2013.03.04	0.2845	0.1387
ETFC	2013.03.05	2013.05.29	0.0820	0.1051
ETFC	2013.05.30	2013.08.22	0.2491	0.0105
ETFC	2013.08.23	2013.11.15	0.2008	0.0599
ETFC	2013.11.18	2014.02.13	0.2360	0.0122
ETFC	2014.02.14	2014.05.12	-0.0023	0.0426
ETFC	2014.05.13	2014.08.06	-0.0314	-0.0061

select Ticker, StartDate, EndDate, round(TickerReturn, 4) as TickerReturn, round(IndustryReturn, 4) as IndustryReturn
  from Performance
  where Ticker = 'TIE'
  order by StartDate;

Ticker	StartDate	EndDate	TickerReturn	IndustryReturn
TIE	2005.08.11	2005.11.03	0.5445	-0.0505
TIE	2005.11.04	2006.02.01	0.5377	0.1753
TIE	2006.02.02	2006.04.28	0.8567	0.0533
TIE	2006.05.01	2006.07.25	-0.2722	-0.0782
TIE	2006.07.26	2006.10.18	0.0703	0.0898
TIE	2006.10.19	2007.01.17	0.0308	0.1188
TIE	2007.01.18	2007.04.13	0.2220	0.1301
TIE	2007.04.16	2007.07.10	-0.0807	0.0831
TIE	2007.07.11	2007.10.03	-0.0406	0.0444
TIE	2007.10.04	2007.12.28	-0.1758	0.0632
TIE	2007.12.31	2008.03.27	-0.4312	-0.0295
TIE	2008.03.28	2008.06.20	-0.0227	0.1089
TIE	2008.06.23	2008.09.16	-0.2694	-0.1321
TIE	2008.09.17	2008.12.10	-0.1966	-0.3578
TIE	2008.12.11	2009.03.10	-0.4555	-0.1943
TIE	2009.03.11	2009.06.04	1.2060	0.6168
TIE	2009.06.05	2009.08.28	-0.2102	0.0735
TIE	2009.08.31	2009.11.23	0.1834	0.1246
TIE	2009.11.24	2010.02.22	0.2294	0.0199
TIE	2010.02.23	2010.05.18	0.3570	-0.0004
TIE	2010.05.19	2010.08.12	0.1778	0.0034
TIE	2010.08.13	2010.11.05	-0.0118	0.1903
TIE	2010.11.08	2011.02.02	0.0016	0.1025
TIE	2011.02.03	2011.04.29	0.0487	0.0384
TIE	2011.05.02	2011.07.26	-0.0796	-0.0405
TIE	2011.07.27	2011.10.19	-0.1642	-0.1743
TIE	2011.10.20	2012.01.17	0.0385	0.1424
TIE	2012.01.18	2012.04.12	-0.1195	0.0340
TIE	2012.04.13	2012.07.09	-0.2007	-0.0708
TIE	2012.07.10	2012.10.02	0.1429	0.0359
TIE	2012.10.03	2012.12.31	0.2909	0.0530
TIE	2013.01.02	2013.03.28	738.3939	0.0186
TIE	2013.04.01	2013.06.24	-0.0336	-0.0498
TIE	2013.06.25	2013.09.18	-0.0351	0.1407
TIE	2013.09.19	2013.12.12	0.5091	0.0111
TIE	2013.12.13	2014.03.12	0.3012	0.0569
TIE	2014.03.13	2014.06.06	-0.3102	0.0345

select Industry, min(IntervalCount) as MinInterval, max(IntervalCount) as MaxInterval
  from (select Industry, Ticker, count(*) as IntervalCount
          from Performance
          group by Industry, Ticker) as TickerCount
  group by Industry
  having MinInterval != MaxInterval;
  
Industry	MinInterval	MaxInterval